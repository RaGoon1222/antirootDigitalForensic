# Memory 분석
>*주로 윈도우에 관한 이야기만 다룬다.*  
포렌식에서 빼놓을 수 없는 메모리 분석에 대한 이야기이다.  
메모리에는 프로세스가 사용한 데이터와 프로세스 자체, 웹 브라우저를 통해 전송된 정보, 복호화된 데이터 등이 기록되어 있다.  
메모리 분석에 대한 연구는 (이 책 기준)현재진행형이므로 파일시스템 분석이나 레지스트리 분석과 비교할 때는 아직 부족하지만 시스템의 많은 정보를 알아낼 수 있으므로 메모리에 대해 반드시 알고 정보 활용 능력을 길러야 한다.

### 메모리 분석의 관심과 장점, 단점
1. 하드디스크에서 실행되지 않고 메모리상에서 바로 실행되는 악성코드의 존재  
이런 경우, 하드디스크를 이미지 파일로 만들어 분석한다 하더라도 악성 파일의 실행 원본 파일이나 흔적을 하드디스크에서 찾을 수 없으므로 메모리 분석이 필요하다.
2. 사용자 응용 프로그램의 프라이버시 보호 기능 강화  
요즘은 암호화나 개인정보보호 프로그램이 일반화되어 범용되어진다.  
이러한 프로그램들은 일반 사용자의 개인 파일들을 보호하지만, 시스템에 침투한 악성코드 또한 보호하는 경우가 발생한다.   
개인정보보호 프로그램이 악성코드 판별 기능이 없기 때문이다.   
이러한 상황에서 악성코드를 분석하려면 메모리 영역을 분석해야한다.  
실행 파일들은 메모리 영역에서는 복호화되어 실행되기 때문이다.  
3. [안티 포렌식(Anti Forensic)](https://en.wikipedia.org/wiki/Anti-computer_forensics)기술의 확산으로 하드 드라이브에 존재하고 있는 데이터의 무결성 불완전  
안티 포렌식 기술은 [루트킷](https://ko.wikipedia.org/wiki/%EB%A3%A8%ED%8A%B8%ED%82%B7)의 경우 나쁘다고 할 수 있지만 데이터 완전 삭제 기술 같은 경우, 일반 사용자들에게는 개인정보파일들을 유출되지 못하도록 하는 기술이기 때문에 좋다고 할 수도 있다.  
아무튼 루트킷이나 데이터 완전 삭제 기술의 경우 무결성을 저해하는 행위이기 때문에 하드디스크가 아닐 경우 메모리에서밖에 복구하지 못한다.  
메모리의 데이터도 완전하지는 않지만 그래도 수집하여 분석하는 것이 도움되기 때문에 메모리 영역을 분석해 데이터를 추출해야 한다.  

위와 같은 이유로 포렌식 관점의 메모리 분석 분야가 관심받기 시작했지만 (이 책 기준)아직까지는 발전 단계가 낮다.  
메모리 분석을 위한 선행 지식이 방대하고 구조는 운영체제마다 다른데다 세부적으로 패치에 따라 달라지기 때문이다. 
 
Live Response에 메모리 분석 과정이 포함될 수 있는데 이는 메모리 분석을 통해 얻는 정보가 대부분 Live Response 정보와 일치하기 때문이다.  
그렇기에 Live Response 과정에 메모리 분석을 넣는 것은 조사관 판단에 달려 있다.  
얻어지는 정보가 비슷하거나 일치한다고 해서 서로 대체하거는 것이 불가능하다.  
Live Response는 메모리 분석과 비교하였을 때 다음과 같은 단점을 지니고 있다.  

1. 도구의 신뢰성 저하  
Live Response 도구들은 대부분 윈도우에서 기본적으로 제공학는 API에 의존하기 때문에 악의적인 해커나 악성 프로그램이 윈도우의 DLL파일을 변조하거나 교체한다면 해당 DLL을 사용하는 도구는 신뢰성이 떨어질 것이다.
2. 분석의 반복성이 없음  
Live Response의 정보는 모두 휘발성으로 다음에 다시 수집한다고 해서 데이터가 일치할 것이라 보장할 수 없다.  
따라서 Live Response의 데이터가 합법적인 절차를 통해 수집했다고 해도 증명하지 못할 수 있다.  
객관적인 증명을 위해서는 동일한 환경에서 동일한 수행이나 입력이 되었을 때 동일한 결과가 나와야 하는데 Live Response는 그렇지 않다.  
3. 분석의 다양성이 없음  
조사관은 휘발성 정보를 증거나 참고용으로 제출했으나 상대편에서 반박하면 객관적인 증명을 위해 다른 방법으로 조사하여 동일한 결과가 나온다는 사실을 증거로 제출해야 한다.  
따라서 조사관은 하나의 휘발성 정보를 수집하기 위해 여러 가지 방법을 사용해야 한다.  
하지만 Live Response는 수행 과정에서는 여러 방법을 사용해 정보를 수집할 수 있지만 조사가 끝나면 다시 정보를 수집할 방법이 없다.  

위와 같이 Live Response는 단점을 가지는 반면 메모리 분석은 Live Response에 대해 다음과 같은 장점을 가지고 있다.  

1. 도구의 신뢰성 보장  
메모리 분석 도구에 사용되는 API는 윈도우의 프로세스/메모리 관련 API가 아닌, 파일시스템의 API이기 때문에 API변조와 상관없이 얻어진 결과이기 때문에 신뢰성을 가진다.  
2. 분석의 반복성 보장  
메모리 분석 대상은 변하지 않기 때문에 언제든지 조사를 반복할 수 있으며 Live Response와 달리 동일한 입력값을 통해 동일한 결과값을 가진다.  
3. 분석의 다양성 보장  
메모리 분석 대상은 Live Response와 달리 조사가 끝이 나도 존재하기 때문에 언제든지 다른 조사 방법이나 새로운 조사 방법을 적용하여 조사를 재개할 수 있다.  

Live Response와 메모리의 장점과 단점에 대해 알아보았다.  
한쪽으로 치우치는 분석보다는 서로 상호작용하는 분석의 수행이 중요하다.  
